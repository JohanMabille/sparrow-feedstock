context:
  name: sparrow
  version: "1.1.0"
  build_number: 1

package:
  name: ${{ name|lower }}
  version: ${{ version }}

source:
  url: https://github.com/man-group/sparrow/archive/${{ version }}.tar.gz
  sha256: 118feef83085efe362001d9f545c88d8a1518b9036b8641ca1142c182f58dc6f

build:
  number: ${{ build_number }}

requirements:
  run_exports:
    - ${{ pin_subpackage('sparrow', upper_bound='x.x') }}
  build:
    - ${{ compiler('cxx') }}
    - ${{ stdlib('c') }}
    - cmake
    - make  # [unix]
  host:
    - howardhinnant_date >=3,<4
  run:
    # howardhinnant_date has run_exports

tests:
  - script:
    - if: unix
      then:
        - test -f ${PREFIX}/include/sparrow/buffer/buffer.hpp
        - test -f ${PREFIX}/include/sparrow/config/sparrow_version.hpp
        - test -f ${PREFIX}/share/cmake/sparrow/sparrowConfig.cmake
        - test -f ${PREFIX}/share/cmake/sparrow/sparrowConfigVersion.cmake
        - test -f ${PREFIX}/share/cmake/sparrow/sparrowTargets.cmake
    - if: win
      then:
        - if not exist %LIBRARY_PREFIX%\include\sparrow\buffer\buffer.hpp (exit 1)
        - if not exist %LIBRARY_PREFIX%\include\sparrow\config\sparrow_version.hpp (exit 1)
        - if not exist %LIBRARY_PREFIX%\share\cmake\sparrow\sparrowConfig.cmake (exit 1)
        - if not exist %LIBRARY_PREFIX%\share\cmake\sparrow\sparrowConfigVersion.cmake (exit 1)
        - if not exist %LIBRARY_PREFIX%\share\cmake\sparrow\sparrowTargets.cmake (exit 1)

about:
  summary: C++20 idiomatic APIs for the Apache Arrow Columnar Format
  description: C++20 idiomatic APIs for the Apache Arrow Columnar Format
  license: Apache-2.0
  license_family: Apache
  license_file: LICENSE
  homepage: https://github.com/man-group/sparrow
  repository: https://github.com/man-group/sparrow

extra:
  recipe-maintainers:
    - jjerphan
    - JohanMabille
    - Klaim
